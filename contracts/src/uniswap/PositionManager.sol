// SPDX-License-Identifier: UNLICENSED
pragma solidity 0.8.26;

import {ERC20} from "@solady-v0.0.245/tokens/ERC20.sol";

import {Currency} from "@uniswap-v4-core/types/Currency.sol";
import {PoolManager} from "@uniswap-v4-core/PoolManager.sol";

import {PositionManager as PositionManagerCore} from "@uniswap-v4-periphery/PositionManager.sol";
import {PositionDescriptor} from "@uniswap-v4-periphery/PositionDescriptor.sol";
import {IWETH9} from "@uniswap-v4-periphery/interfaces/external/IWETH9.sol";
import {IAllowanceTransfer} from "permit2/src/interfaces/IAllowanceTransfer.sol";

import {Predeploys} from "@contracts-bedrock/libraries/Predeploys.sol";
import {Preinstalls} from "@contracts-bedrock/libraries/Preinstalls.sol";

// The bytecode here is a compilation of the contract below. `_pay` is not marked as a virtual function
// so it was manually added to the contract in the dependency. However commented out since compilation would
// fail unless upstreamed.
library PositionManagerLib {
  bytes internal constant MODIFIED_BYTECODE = "610180806040523461052d57604081614ff680380380916100208285610531565b83398101031261052d5780516001600160a01b038116919082900361052d57602001516001600160a01b038116919082900361052d57604051610064604082610531565b6018815260208101907f556e697377617020763420506f736974696f6e73204e46540000000000000000825260405161009e604082610531565b600b81526a554e492d56342d504f534d60a81b602082015281516001600160401b038111610441575f54600181811c91168015610523575b602082101461042357601f81116104c1575b50806020601f8211600114610460575f91610455575b508160011b915f199060031b1c1916175f555b8051906001600160401b0382116104415760015490600182811c92168015610437575b60208310146104235781601f8493116103b5575b50602090601f831160011461034f575f92610344575b50508160011b915f199060031b1c1916176001555b5190208060c0524660a05260405160208101917f8cad95687ba82c2ce50e74f7b754645e5117c3a5bec8151c0726d5857980a86683526040820152466060820152306080820152608081526101c960a082610531565b51902060805260e052620493e0610100526e22d473030f116ddee9f6b43ac78ba36101205273420000000000000000000000000000000000000661014052600160085561016052604051614aa19081610555823960805181611ecc015260a05181611ea6015260c05181611f1b015260e0518181816109a901528181610c1b01528181610e5d01528181611493015281816117c10152818161185501528181611b1301528181611bcd0152818161228c01528181612340015281816126a901528181613127015281816131da0152818161326101528181613336015281816135c3015281816137be01528181613b6501528181613cc901528181613e0401528181613ecf01528181613f1c015261460f01526101005181818161104c01526128db015261012051818181610386015281816108bf0152610b41015261014051818181611084015281816122f701528181612eb901528181612f1501528181612fe801526130580152610160518181816112290152611a330152f35b015190505f8061015e565b60015f9081528281209350601f198516905b81811061039d5750908460019594939210610385575b505050811b01600155610173565b01515f1960f88460031b161c191690555f8080610377565b92936020600181928786015181550195019301610361565b60015f529091507fb10e2d527612073b26eecdfd717e6a320cf44b4afac2b0732d9fcbe2b7fa0cf6601f840160051c81019160208510610419575b90601f859493920160051c01905b81811061040b5750610148565b5f81558493506001016103fe565b90915081906103f0565b634e487b7160e01b5f52602260045260245ffd5b91607f1691610134565b634e487b7160e01b5f52604160045260245ffd5b90508301515f6100fe565b5f8080528181209250601f198416905b8181106104a957509083600194939210610491575b5050811b015f55610111565b8501515f1960f88460031b161c191690555f80610485565b9192602060018192868a015181550194019201610470565b5f80527f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e563601f830160051c81019160208410610519575b601f0160051c01905b81811061050e57506100e8565b5f8155600101610501565b90915081906104f8565b90607f16906100d6565b5f80fd5b601f909101601f19168101906001600160401b038211908210176104415760405256fe60806040526004361015610022575b3615610018575f80fd5b6100206122f4565b005b5f3560e01c80622a3e3a1461029057806301ffc9a71461028b57806305c1ee201461028657806306fdde0314610281578063081812fc1461027c578063095ea7b3146102775780630f5730f11461027257806312261ee71461026d57806316a24131146102685780631efeed331461026357806323b872dd1461025e5780632b67b570146102595780632b9261de146102545780633644e5151461024f5780633aea60f01461024a57806342842e0e146102455780634767565f146102405780634aa4a4fc1461023b5780634afe393c14610236578063502e1a16146102315780635a9d7a681461022c5780636352211e1461022757806370a082311461022257806375794a3c1461021d5780637ba03aad1461021857806386b6be7d1461021357806389097a6a1461020e57806391dd73461461020957806395d89b4114610204578063a22cb465146101ff578063ac9650d8146101fa578063ad0b27fb146101f5578063b88d4fde146101f0578063c87b56dd146101eb578063d737d0c7146101e6578063dc4c90d3146101e1578063dd46508f146101dc578063e985e9c5146101d75763f70204050361000e57611cc2565b611c6b565b611b42565b611afe565b611acc565b6119fd565b611801565b6117ad565b6116cf565b61163d565b611588565b611460565b611436565b6113b2565b611368565b611308565b611288565b611258565b611214565b6111cb565b6110e3565b61106f565b611035565b610e4a565b610d6f565b610d43565b610bd9565b610af6565b610995565b610920565b6108ee565b6108aa565b6107b7565b61073a565b610708565b6105f0565b610577565b610509565b610328565b6001600160a01b031690565b6001600160a01b038116036102b257565b5f80fd5b35906102c1826102a1565b565b9181601f840112156102b2578235916001600160401b0383116102b257602083818601950101116102b257565b805180835260209291819084018484015e5f828201840152601f01601f1916010190565b9060206103259281815201906102f0565b90565b60603660031901126102b257600435610340816102a1565b602435906001600160401b0382116102b2578136039160606003198401126102b2576044356001600160401b0381116102b2576103819036906004016102c3565b6060947f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031693909290843b156102b257604051632a2d80d160e01b81526001600160a01b039096166004808801919091526060602488015260c48701949082013590602219018112156102b25781016024600482013591019460018060401b0382116102b2578160071b360386136102b25760606064890152819052869460e48601949392915f5b8181106104cf575050506104805f96948694889460448561046861045860248b99016102b6565b6001600160a01b03166084890152565b013560a4860152848303600319016044860152611dd5565b03925af190816104b5575b506104ac57506104a861049c611e3e565b60405191829182610314565b0390f35b6104a89061049c565b806104c35f6104c9936105cd565b8061058f565b5f61048b565b91965091929394608080826104e66001948b611d76565b019701910191889695949392610431565b6001600160e01b03198116036102b257565b346102b25760203660031901126102b2576020600435610528816104f7565b63ffffffff60e01b166301ffc9a760e01b8114908115610566575b8115610555575b506040519015158152f35b635b5e139f60e01b1490505f61054a565b6380ac58cd60e01b81149150610543565b60203660031901126102b2576100206004353361236f565b5f9103126102b257565b634e487b7160e01b5f52604160045260245ffd5b60a081019081106001600160401b038211176105c857604052565b610599565b601f909101601f19168101906001600160401b038211908210176105c857604052565b346102b2575f3660031901126102b2576040515f80548060011c90600181169081156106c6575b6020831082146106b25782855260208501919081156106995750600114610649575b6104a88461049c818603826105cd565b5f8080529250907f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e5635b8184106106855750500161049c82610639565b805484840152602090930192600101610672565b60ff191682525090151560051b01905061049c82610639565b634e487b7160e01b5f52602260045260245ffd5b91607f1691610617565b5f52600260205260405f2090565b5f52600460205260405f2090565b5f52600960205260405f2090565b5f52600760205260405f2090565b346102b25760203660031901126102b2576004355f526004602052602060018060a01b0360405f205416604051908152f35b346102b25760403660031901126102b257600435610757816102a1565b6024355f818152600260205260409020546001600160a01b0316913383141580610797575b61078957610020926123b5565b6282b42960e81b5f5260045ffd5b50825f52600560205260ff6107af3360405f206111b6565b54161561077c565b60a03660031901126102b2576004356107cf816102a1565b60243560443591606435926084356001600160401b0381116102b2576107f99036906004016102c3565b9482421161089b5761089085610896936100209861088a885f80998682526002602052818960018060a01b036040832054169c8d9981604051977f49ecf333e5b8c95c40fdafc95c1ad136e8914a8fb55e9dc8bb01eaa83a2df9ad8952602089019060018060a01b031681526040890192835260608901948552608089019687528160a08a209952525252526123fe565b91612483565b8261236f565b6123b5565b635a9165ff60e01b5f5260045ffd5b346102b2575f3660031901126102b2576040517f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602090f35b346102b25760203660031901126102b2576004355f526007602052602060018060a01b0360405f205416604051908152f35b346102b25760203660031901126102b257602061095760043561094281612010565b919082851c60020b9260081c60020b91612617565b6040516001600160801b039091168152f35b60609060031901126102b257600435610981816102a1565b9060243561098e816102a1565b9060443590565b346102b2576109a336610969565b916109cd7f000000000000000000000000000000000000000000000000000000000000000061272c565b610ae7578291610a6c6109f76109f26109e5866106d0565b546001600160a01b031690565b610295565b6001600160a01b0384169290610a0e9084146127a8565b6001600160a01b03811693610a4790610a288615156127e1565b8433148015610acc575b8015610ab0575b610a4290612821565b61119d565b80545f19019055610a578161119d565b80546001019055610a67856106d0565b611e6d565b610a7d610a78846106de565b61285e565b5f80516020614a4c8339815191525f80a4610aa1610a9a826106ec565b5460ff1690565b610aa757005b6100209061286e565b50610a42610ac36109f26109e58a6106de565b33149050610a39565b50610ae2610a9a33610add84611184565b6111b6565b610a32565b6306a582ff60e51b5f5260045ffd5b6101003660031901126102b257600435610b0f816102a1565b60c03660231901126102b25760e4356001600160401b0381116102b257610b3a9036906004016102c3565b60609290917f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316803b156102b257610480935f8094604051968795869485936302b67b5760e41b855260018060a01b03166004850152610ba460248501611d0a565b60a435610bb0816102a1565b6001600160a01b031660a485015260c43560c485015261010060e4850152610104840191611dd5565b60603660031901126102b257602435600435610bf4826102a1565b6044356001600160401b0381116102b257610c139036906004016102c3565b610c3f9391937f000000000000000000000000000000000000000000000000000000000000000061272c565b610ae757610c4d833361295e565b15610d30576001600160a01b03610c666109e5856106fa565b1680610d0d57505f83815260096020526040902080546001179055610cdd90610cd9906001600160a01b03841695610cd390610ca588610a67896106fa565b610cc56040519384926346abfb5960e11b60208501528960248501611e8c565b03601f1981018352826105cd565b836129e4565b1590565b610d0857507f9709492381f90bdc5938bb4e3b8e35b7e0eac8af058619e27191c5a40ce79fa95f80a3005b612a0c565b6312fdec5f60e11b5f5260048490526001600160a01b031660245260445ffd5b5ffd5b6301952d1b60e31b5f523360045260245ffd5b346102b2575f3660031901126102b2576020610d5d611ea3565b604051908152f35b801515036102b257565b60c03660031901126102b257600435610d87816102a1565b602435610d93816102a1565b60443590610da082610d65565b6064359260843560a4356001600160401b0381116102b257610dc69036906004016102c3565b86929192421161089b5783610e45936108909261088a885f6100209c8189818f81604051977f6673cb397ee2a50b6b8401653d3638b4ac8b3db9c28aa6870ffceb7574ec2f768952602089019060018060a01b03168152600160408a019316835260608901948552608089019687528160a08a209952525252526123fe565b612bbc565b346102b257610e5836610969565b610e817f000000000000000000000000000000000000000000000000000000000000000061272c565b610ae757610e946109f26109e5836106d0565b6001600160a01b0384169290610eab9084146127a8565b6001600160a01b0381169282908490610ec58215156127e1565b803314801561101f575b8015611003575b610edf90612821565b610ee88761119d565b80545f19019055610ef88461119d565b80546001019055610f0c84610a67856106d0565b610f18610a78846106de565b5f80516020614a4c8339815191525f80a4610f35610a9a836106ec565b610ff5575b3b15918215610f4d575b61002083611f75565b604051630a85bd0160e11b81523360048201526001600160a01b039490941660248501526044840191909152608060648401525f6084840181905260209250839160a49183915af18015610ff057610020915f91610fc1575b506001600160e01b031916630a85bd0160e11b145f80610f44565b610fe3915060203d602011610fe9575b610fdb81836105cd565b810190611f60565b5f610fa6565b503d610fd1565b611df5565b610ffe8261286e565b610f3a565b50610edf6110166109f26109e5866106de565b33149050610ed6565b50611030610a9a33610add8a611184565b610ecf565b346102b2575f3660031901126102b25760206040517f00000000000000000000000000000000000000000000000000000000000000008152f35b346102b2575f3660031901126102b2576040517f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602090f35b9181601f840112156102b2578235916001600160401b0383116102b2576020808501948460051b0101116102b257565b60403660031901126102b2576004356001600160401b0381116102b25761110e9036906004016102c3565b6024356001600160401b0381116102b25761112d9036906004016110b3565b915f80516020614a2c8339815191525c6001600160a01b03166111755761116393335f80516020614a2c8339815191525d612c35565b5f5f80516020614a2c8339815191525d005b6337affdbf60e11b5f5260045ffd5b6001600160a01b03165f90815260056020526040902090565b6001600160a01b03165f90815260036020526040902090565b9060018060a01b03165f5260205260405f2090565b346102b25760403660031901126102b2576004356111e8816102a1565b6024359060018060a01b03165f52600660205260405f20905f52602052602060405f2054604051908152f35b346102b2575f3660031901126102b2576040517f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602090f35b346102b25760203660031901126102b2576020611276600435611fed565b6040516001600160a01b039091168152f35b346102b25760203660031901126102b2576004356112a5816102a1565b6001600160a01b031680156112d4575f5260036020526104a860405f2054604051918291829190602083019252565b60405162461bcd60e51b815260206004820152600c60248201526b5a45524f5f4144445245535360a01b6044820152606490fd5b346102b2575f3660031901126102b2576020600854604051908152f35b80516001600160a01b03908116835260208083015182169084015260408083015162ffffff169084015260608083015160020b9084015260809182015116910152565b346102b25760203660031901126102b25760c0611386600435612010565b6113936040518093611325565b60a0820152f35b66ffffffffffffff19165f52600a60205260405f2090565b346102b25760203660031901126102b25760043566ffffffffffffff1981168091036102b2575f908152600a60209081526040918290208054600182015460029283015485516001600160a01b0393841681528383169581019590955260a082811c62ffffff169686019690965260b89190911c90920b6060840152166080820152f35b346102b25760203660031901126102b2576004355f526009602052602060405f2054604051908152f35b346102b25760203660031901126102b2576004356001600160401b0381116102b2576114909036906004016102c3565b907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031633036115795760408135189063ffffffff60408201351663ffffffe0601f8201169260608401602084013518179282019260608401359483641fffffffe08760051b16805f905b8881831061154a579050608092915001019101101761153d576060608063ffffffff611532961694019201612c35565b6104a861049c611e2a565b633b99b53d5f526004601cfd5b8294509263ffffffe0601f60808060209687969801013599848b1817998d010135011601019201869291611502565b63570c108560e11b5f5260045ffd5b346102b2575f3660031901126102b2576040515f6001548060011c9060018116908115611633575b6020831082146106b257828552602085019190811561069957506001146115e1576104a88461049c818603826105cd565b60015f9081529250907fb10e2d527612073b26eecdfd717e6a320cf44b4afac2b0732d9fcbe2b7fa0cf65b81841061161f5750500161049c82610639565b80548484015260209093019260010161160c565b91607f16916115b0565b346102b25760403660031901126102b25761002060043561165d816102a1565b6024359061166a82610d65565b33612bbc565b602081016020825282518091526040820191602060408360051b8301019401925f915b8383106116a257505050505090565b90919293946020806116c0600193603f1986820301875289516102f0565b97019301930191939290611693565b60203660031901126102b2576004356001600160401b0381116102b2576116fa9036906004016110b3565b90611704826120bd565b9161171260405193846105cd565b808352601f19611721826120bd565b015f5b81811061179c5750505f5b81811061174457604051806104a88682611670565b5f806117518385876120e8565b906117616040518093819361212e565b0390305af461176e611e3e565b90156117945790600191611782828761213b565b5261178d818661213b565b500161172f565b602081519101fd5b806060602080938801015201611724565b60203660031901126102b2576004356117e57f000000000000000000000000000000000000000000000000000000000000000061272c565b610ae7576117f3813361295e565b15610d30576100209061286e565b346102b25760803660031901126102b25760043561181e816102a1565b6024359061182b826102a1565b6044356064356001600160401b0381116102b25761184d9036906004016102c3565b9390916118797f000000000000000000000000000000000000000000000000000000000000000061272c565b610ae75761188c6109f26109e5836106d0565b6001600160a01b03851692906118a39084146127a8565b6001600160a01b03811692829084906118bd8215156127e1565b80331480156119e7575b80156119cb575b6118d790612821565b6118e08861119d565b80545f190190556118f08461119d565b8054600101905561190484610a67856106d0565b611910610a78846106de565b5f80516020614a4c8339815191525f80a461192d610a9a836106ec565b6119bd575b3b15938415611945575b61002085611f75565b602094505f9061196c60405197889687958694630a85bd0160e11b8652336004870161214f565b03925af18015610ff057610020915f9161199e575b506001600160e01b031916630a85bd0160e11b145f80808061193c565b6119b7915060203d602011610fe957610fdb81836105cd565b5f611981565b6119c68261286e565b611932565b506118d76119de6109f26109e5866106de565b331490506118ce565b506119f8610a9a33610add8b611184565b6118c7565b346102b25760203660031901126102b25760043560405163e9dc637560e01b815230600482015260248101919091525f816044817f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165afa8015610ff0575f90611a7a575b6104a89060405191829182610314565b503d805f833e611a8a81836105cd565b8101906020818303126102b2578051906001600160401b0382116102b2570181601f820112156102b2576104a891816020611ac793519101612180565b611a6a565b346102b2575f3660031901126102b2576040516001600160a01b035f80516020614a2c8339815191525c168152602090f35b346102b2575f3660031901126102b2576040517f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602090f35b60403660031901126102b2576004356001600160401b0381116102b257611b6d9036906004016102c3565b6024355f80516020614a2c8339815191525c6001600160a01b031661117557335f80516020614a2c8339815191525d804211611c59576040516348c8949160e01b8152602060048201525f8180611bc8602482018789611dd5565b0381837f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165af18015610ff057611c0a575b610020612c23565b3d805f833e611c1981836105cd565b8101906020818303126102b2578051906001600160401b0382116102b257019080601f830112156102b2578151611c5292602001612180565b5080611c02565b63bfb22adf60e01b5f5260045260245ffd5b346102b25760403660031901126102b257602060ff611cb6600435611c8f816102a1565b60243590611c9c826102a1565b6001600160a01b03165f90815260058552604090206111b6565b54166040519015158152f35b366003190160c081126102b25760a0136102b2576020611cec60a435611ce7816102a1565b6121e3565b6040519060020b8152f35b359065ffffffffffff821682036102b257565b602435611d16816102a1565b6001600160a01b03168152604435611d2d816102a1565b6001600160a01b0316602082015260643565ffffffffffff8116908190036102b257604082015260843565ffffffffffff811681036102b25765ffffffffffff60609116910152565b65ffffffffffff611dcf606080938035611d8f816102a1565b6001600160a01b031686526020810135611da8816102a1565b6001600160a01b0316602087015283611dc360408301611cf7565b16604087015201611cf7565b16910152565b908060209392818452848401375f828201840152601f01601f1916010190565b6040513d5f823e3d90fd5b604051906102c16080836105cd565b6001600160401b0381116105c857601f01601f191660200190565b60405190611e396020836105cd565b5f8252565b3d15611e68573d90611e4f82611e0f565b91611e5d60405193846105cd565b82523d5f602084013e565b606090565b80546001600160a01b0319166001600160a01b03909216919091179055565b604090610325949281528160208201520191611dd5565b467f000000000000000000000000000000000000000000000000000000000000000003611eee577f000000000000000000000000000000000000000000000000000000000000000090565b60405160208101907f8cad95687ba82c2ce50e74f7b754645e5117c3a5bec8151c0726d5857980a86682527f0000000000000000000000000000000000000000000000000000000000000000604082015246606082015230608082015260808152611f5a60a0826105cd565b51902090565b908160209103126102b25751610325816104f7565b15611f7c57565b60405162461bcd60e51b815260206004820152601060248201526f155394d0519157d49150d2541251539560821b6044820152606490fd5b15611fbb57565b60405162461bcd60e51b815260206004820152600a6024820152691393d517d3525395115160b21b6044820152606490fd5b5f908152600260205260409020546001600160a01b0316906102c1821515611fb4565b5f608060405161201f816105ad565b82815282602082015282604082015282606082015201525f52600960205260405f20548066ffffffffffffff19165f52600a60205260405f206120ba6120aa60026040519361206d856105ad565b80546001600160a01b0390811686526001820154908116602087015262ffffff60a082901c16604087015260b81c60020b60608601520154610295565b6001600160a01b03166080830152565b91565b6001600160401b0381116105c85760051b60200190565b634e487b7160e01b5f52603260045260245ffd5b91908110156121295760051b81013590601e19813603018212156102b25701803591906001600160401b0383116102b25760200182360381136102b2579190565b6120d4565b908092918237015f815290565b80518210156121295760209160051b010190565b6001600160a01b03918216815291166020820152604081019190915260806060820181905261032593910191611dd5565b92919261218c82611e0f565b9161219a60405193846105cd565b8294818452818301116102b2578281602093845f96015e010152565b8060020b036102b257565b908160209103126102b25751610325816121b6565b62ffffff8116036102b257565b60405163313b65df60e11b8152906004356121fd816102a1565b6001600160a01b03166004830152602435612217816102a1565b6001600160a01b0316602483015262ffffff604435612235816121d6565b166044830152606435612247816121b6565b60020b606483015261226e60843561225e816102a1565b6001600160a01b03166084840152565b6001600160a01b0390811660a4830152602090829060c49082905f907f0000000000000000000000000000000000000000000000000000000000000000165af15f91816122c3575b506103255750627fffff90565b6122e691925060203d6020116122ed575b6122de81836105cd565b8101906121c1565b905f6122b6565b503d6122d4565b337f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031614158061233c575b61232d57565b631c5deabb60e11b5f5260045ffd5b50337f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03161415612327565b90600160ff82161b9160018060a01b03165f52600660205260405f209060081c5f5260205260405f208181541880915516156123a757565b623f613760e71b5f5260045ffd5b90825f5260046020526123cb8160405f20611e6d565b6001600160a01b0390811691167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b9255f80a4565b90612407611ea3565b916040519261190160f01b8452600284015260228301525f604060428420938281528260208201520152565b91908260409103126102b2576020823592013590565b634e487b7160e01b5f52601160045260245ffd5b60ff601b9116019060ff821161246f57565b612449565b90604010156121295760400190565b90833b61258e576041810361254257906020926124f4836124cc6124c66124b86124b05f98880188612433565b949097612474565b356001600160f81b03191690565b60f81c90565b935b604051948594859094939260ff6060936080840197845216602083015260408201520152565b838052039060015afa15610ff0575f516001600160a01b0316908115612533576001600160a01b03160361252457565b632057875960e21b5f5260045ffd5b638baa579f60e01b5f5260045ffd5b906040820361257f5760209261255f825f946124f4940190612433565b9092906001600160ff1b038116906125799060ff1c61245d565b936124ce565b634be6321b60e01b5f5260045ffd5b90926125b49360209360405195869485938493630b135d3f60e11b855260048501611e8c565b03916001600160a01b03165afa908115610ff0575f916125f8575b506001600160e01b0319166374eca2c160e11b016125e957565b632c19a72f60e21b5f5260045ffd5b612611915060203d602011610fe957610fdb81836105cd565b5f6125cf565b92906126529260a092604051956026870152600686015260038501523084525f603a600c860120948160408201528160208201525220613c3a565b6006810180911161246f57604080516020818101948552918101929092526126a59290916126838160608101610cc5565b51902060405180938192631e2eaeaf60e01b8352600483019190602083019252565b03817f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165afa908115610ff0575f916126ee575b506001600160801b031690565b612710915060203d602011612716575b61270881836105cd565b81019061271d565b5f6126e1565b503d6126fe565b908160209103126102b2575190565b60405163789add5560e11b81527fc090fc4683624cfc3884e9d8de5eca132f2d0ec062aff75d43c0465d5ceeab23600482015290602090829060249082906001600160a01b03165afa908115610ff0575f91612789575b50151590565b6127a2915060203d6020116127165761270881836105cd565b5f612783565b156127af57565b60405162461bcd60e51b815260206004820152600a60248201526957524f4e475f46524f4d60b01b6044820152606490fd5b156127e857565b60405162461bcd60e51b81526020600482015260116024820152701253959053125117d49150d25412515395607a1b6044820152606490fd5b1561282857565b60405162461bcd60e51b815260206004820152600e60248201526d1393d517d055551213d49256915160921b6044820152606490fd5b80546001600160a01b0319169055565b6001600160a01b036128826109e5836106fa565b1690811561294f575f818152600960205260409020805460ff191690556128ab610a78826106fa565b813b6128d8575b7fa0ebb1de82db929a9153472f37d3a66dbede4436258311ad0f52a35a2c91d1505f80a3565b5a7f000000000000000000000000000000000000000000000000000000000000000080911061294a57823b156102b257604051632bd1774560e21b815260048101839052905f908290602490829084908890f1612936575b506128b2565b806104c35f612944936105cd565b5f612930565b612c85565b63046fcd8560e31b5f5260045ffd5b6001600160a01b0361296f83611fed565b6001600160a01b03831691168114929083156129c3575b50821561299257505090565b60ff92506129be91906001600160a01b03906129ad90611fed565b165f52600560205260405f206111b6565b541690565b5f828152600460205260408120546001600160a01b03169091149350612986565b803b156129fd57815f92918360208194519301915af190565b637c402b2160e01b5f5260045ffd5b6040516390bfb86560e01b81526001600160a01b0390911660048201526346abfb5960e11b60248201526080604482015260a03d601f01601f191690810160648301523d60848301523d5f60a484013e808201600460a482015260c46340f52f4f60e11b91015260e40190fd5b6040516390bfb86560e01b81526001600160a01b03909116600482015263a9059cbb60e01b60248201526080604482015260a03d601f01601f191690810160648301523d60848301523d5f60a484013e808201600460a482015260c4633c9fd93960e21b91015260e40190fd5b6040516390bfb86560e01b81526001600160a01b0390911660048201525f602482018190526080604483015260a03d601f01601f191690810160648401523d6084840152903d9060a484013e808201600460a482015260c4633d2cec6f60e21b91015260e40190fd5b6040516390bfb86560e01b81526001600160a01b03909116600482015263b1a9116f60e01b60248201526080604482015260a03d601f01601f191690810160648301523d60848301523d5f60a484013e808201600460a482015260c463ace9448160e01b91015260e40190fd5b60207f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c319160018060a01b031692835f5260058252612bfd8160405f206111b6565b805460ff191695151560ff81169690961790556040519485526001600160a01b031693a3565b5f5f80516020614a2c8339815191525d565b90929193828403612c76575f5b84811015612c6e57600190612c68818501612c5e83888b6120e8565b913560f81c612c94565b01612c42565b509350505050565b63aaad13f760e01b5f5260045ffd5b6376a1e1d360e11b5f5260045ffd5b909190600b811015612d965780612cbf5750612cb3906102c192613a82565b94939093929192613bf1565b60048103612cde5750612cd5906102c192613472565b93929092613b1c565b60018103612d005750612cf4906102c192613a82565b94939093929192613ac4565b60028103612d2f5750612d19612d29916102c19361383d565b98909796919592959493946130be565b95613924565b60058103612d5b5750612d48612d55916102c1936136df565b97909695919492946130be565b946137a1565b9160038314612d7e575050610d2d91505b635cda29d760e01b5f52600452602490565b6102c1925090612d8d91613472565b939290926134ae565b600d8103612db25750612dac906102c1926130ab565b90613447565b60118103612dda5750612dcb612dd4916102c19361322c565b929091926130be565b9161342c565b600b8103612e0e5750612e08612df6612e02926102c19461322c565b938294939291936132ed565b92613308565b9161332d565b600e8103612e405750612e34612e2a612e3a926102c19461322c565b92829492916130be565b92613244565b91613258565b60128103612e5b5750612e56906102c192612f47565b6131d3565b60138103612e775750612e71906102c1926130ab565b9061310e565b60148103612e9e5750612e90612e98916102c1936130ab565b9190916130be565b906130f0565b60158103612eec5750612eb7612ee7916102c193612f47565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031690612f9e565b61304e565b9160168314612f01575050610d2d9150612d6c565b6102c19250612f4291612f1391612f47565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316612f53565b612fde565b9060201161153d573590565b612f5e903090613c5a565b600160ff1b8214612f99578115612f88575b8111612f795790565b631e9acf1760e31b5f5260045ffd5b9050612f935f613cc2565b90612f70565b905090565b90612fa9305f613c5a565b90600160ff1b8314612fd8578215612fc6575b508111612f795790565b612fd1919250613cc2565b905f612fbc565b50905090565b80612fe65750565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031690813b156102b2575f91602483926040519485938492632e1a7d4d60e01b845260048401525af18015610ff0576130445750565b5f6102c1916105cd565b806130565750565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316803b156102b2575f90600460405180948193630d0e30db60e41b83525af18015610ff0576130445750565b919060401161153d576020823592013590565b6001600160a01b038116600181036130e45750505f80516020614a2c8339815191525c90565b60020361032557503090565b906130fa82613d1f565b908161310557505050565b6102c192613d6c565b9061311882613dfd565b9081156131be5781116131a5577f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031691823b156102b25760405163203c2d1360e21b81526001600160a01b0390911660048201526024810191909152905f908290604490829084905af18015610ff0576131975750565b806104c35f6102c1936105cd565b6102c1915f80516020614a2c8339815191525c90613258565b505050565b600160ff1b811461246f575f0390565b6131fe81307f0000000000000000000000000000000000000000000000000000000000000000613e54565b905f80516020614a2c8339815191525c5f83121561322257612e086102c1936131c3565b6102c19291613258565b9060601161153d578035916040602083013592013590565b9081613254576103259150613dfd565b5090565b9082156131be577f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316803b156102b257604051630b0d9c0960e01b81526001600160a01b03938416600482015291909216602482015260448101929092525f908290606490829084905af18015610ff0576132d85750565b806132e45f80936105cd565b8003126102b257565b15613304575f80516020614a2c8339815191525c90565b3090565b90600160ff1b820361331e576103259150613d1f565b81613254576103259150613cc2565b9082156131be577f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031691823b156102b257604051632961046560e21b81526001600160a01b03821660048201525f8160248183885af18015610ff057613418575b506001600160a01b0381166133e7575050602090600460405180948193630476982d60e21b83525af18015610ff0576133cc5750565b6133e49060203d6020116127165761270881836105cd565b50565b5f93602093926133f692613eb6565b600460405180948193630476982d60e21b83525af18015610ff0576133cc5750565b806104c35f613426936105cd565b5f613396565b9161343e6102c19382612e3a82613dfd565b612e3a82613dfd565b906102c1916134695f80516020614a2c8339815191525c9182612e0882613cc2565b612e0882613cc2565b919082359260208101359260408201359263ffffffff60608401351683019063ffffffff8235169360208084019386010191011061153d579190565b939290925f80516020614a2c8339815191525c6134cb868261295e565b1561365e57506134da85612010565b9290938360081c60020b958460201c60020b966135086134fc89838a8d612617565b6001600160801b031690565b966135128a611fed565b955f61351d8c6106ec565b556135278b613f90565b5f9989613559575b505050505050508160ff16613546575b5050505050565b61354f946140fd565b5f8080808061353f565b60409495969a50906135be916135996135796135748d614028565b6131c3565b9161358f613585611e00565b97889060020b9052565b60020b6020870152565b84860152606084018c90528451632d35e7ed60e11b81529a8b94859460048601613694565b03815f7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165af18015610ff0575f965f9161361e575b509061360d82613612949398614041565b61408b565b5f80808080808061352f565b61360d97506136129392915061364b9060403d604011613657575b61364381836105cd565b81019061367e565b979097919293506135fc565b503d613639565b6301952d1b60e31b5f9081526001600160a01b0391909116600452602490fd5b91908260409103126102b2576020825192015190565b606061032595936136a88361014095611325565b805160020b60a0840152602081015160020b60c0840152604081015160e08401520151610100820152816101208201520191611dd5565b91908260a08101359260c08201359260e083013592610100810135926101208201359263ffffffff6101408401351683019063ffffffff8235169360208084019386010191011061153d579190565b91908260a09103126102b257604051613746816105ad565b60808082948035613756816102a1565b84526020810135613766816102a1565b60208501526040810135613779816121d6565b6040850152606081013561378c816121b6565b606085015201359161379d836102a1565b0152565b90916102c19796959493926137e260a06137bb368661372e565b207f0000000000000000000000000000000000000000000000000000000000000000614182565b5050506138366137f18361420e565b916137fb8561420e565b61380e8735613809816102a1565b613dfd565b9060208801359461381e866102a1565b6001600160801b039561383090613dfd565b9361452e565b1692613924565b9091819260a08301359260c08101359260e08201359261010083013592610120810135926101408201359263ffffffff6101608401351683019063ffffffff8235169360208084019386010191011061153d579190565b600260806102c1936138b081356138aa816102a1565b85611e6d565b600184016138cb60208301356138c5816102a1565b82611e6d565b60408201356138d9816121d6565b815460608401356138e9816121b6565b60b81b62ffffff60b81b169162ffffff60a01b9060a01b169065ffffffffffff60a01b19161717905501359161391e836102a1565b01611e6d565b909194969297939597600854926001840160085560018060a01b038a169961394d8b15156127e1565b5f858152600260205260409020546001600160a01b0316613a4c576139df613a2e98613a2893876102c19e61399886613988613a209861119d565b80546001019055610a67846106d0565b5f5f80516020614a4c8339815191528180a46139b4368861372e565b63ffffff009060a066ffffffffffffff199120169160081b169162ffffff60201b9060201b16171790565b92836139ea876106ec565b5566ffffffffffffff19841685613a106001613a058461139a565b015460b81c60020b90565b60020b15613a34575b5050614028565b92369061372e565b906145bd565b50614686565b613a40613a459261139a565b613894565b5f85613a19565b60405162461bcd60e51b815260206004820152600e60248201526d1053149150511657d3525395115160921b6044820152606490fd5b909181359260208301359260408101359260608201359263ffffffff60808401351683019063ffffffff8235169360208084019386010191011061153d579190565b90959495939192935f80516020614a2c8339815191525c613ae5838261295e565b1561365e57509561360d92826135746102c19899613b10613b08613b1697612010565b939092614028565b916145bd565b90614041565b949394929091925f80516020614a2c8339815191525c613b3c828261295e565b1561365e57506102c19495613bec9282613b58613b1694612010565b90613b10613b8960a083207f0000000000000000000000000000000000000000000000000000000000000000614182565b505050613be6613b9e8560081c60020b61420e565b91613bae8660201c60020b61420e565b8551613bc2906001600160a01b0316613dfd565b60208701516001600160801b039591929190613830906001600160a01b0316613dfd565b16614028565b614686565b90959495939192935f80516020614a2c8339815191525c613c12838261295e565b1561365e575095613bec9282613b106102c19899613c32613b1696612010565b929091614028565b604051602081019182526006604082015260408152611f5a6060826105cd565b6001600160a01b038116613c6d57503190565b6040516370a0823160e01b81526001600160a01b0392831660048201529160209183916024918391165afa908115610ff0575f91613ca9575090565b610325915060203d6020116127165761270881836105cd565b613ced81307f0000000000000000000000000000000000000000000000000000000000000000613e54565b905f8213613cff5750610325906131c3565b63019a8d9360e51b5f9081526001600160a01b0391909116600452602490fd5b6001600160a01b038116613d3257504790565b6040516370a0823160e01b815230600482015290602090829060249082906001600160a01b03165afa908115610ff0575f91613ca9575090565b9091906001600160a01b038116613d9957505f808080613d8d94865af11590565b613d945750565b612ae6565b6040805163a9059cbb60e01b81526001600160a01b039094166004850152602484019290925291905f9060208260448582885af13d15601f3d11600185511416171692828152826020820152015215613def5750565b6001600160a01b0316612a79565b613e2881307f0000000000000000000000000000000000000000000000000000000000000000613e54565b905f8212613e34575090565b634c085bf160e01b5f9081526001600160a01b0391909116600452602490fd5b6001600160a01b039182165f9081529282166020908152604093849020935163789add5560e11b815260048101949094529183916024918391165afa908115610ff0575f91613ca9575090565b908160209103126102b2575161032581610d65565b91906001600160a01b0381163003613efd57506102c1917f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031690613d6c565b6040516323b872dd60e01b81526001600160a01b0391821660048201527f00000000000000000000000000000000000000000000000000000000000000008216602482015260448101929092529091602091839160649183915f91165af18015610ff057613f685750565b6133e49060203d602011613f89575b613f8181836105cd565b810190613ea1565b503d613f77565b5f818152600260205260408120546001600160a01b0316613fb2811515611fb4565b80825260036020526040822082198154019055613fce836106d0565b80546001600160a01b03600385901b81811b1990921690851690911b179055613ff6836106de565b80546001600160a01b03600385901b81811b1990921690851690911b1790555f80516020614a4c8339815191528280a4565b905f821261403257565b6393dafdf160e01b5f5260045ffd5b614064906140568360801d8260801d0361473a565b92600f0b90600f0b0361473a565b60018060801b03169060801b1790565b6001600160801b0390811660045216602452604490565b908160801d61409981614748565b6001600160801b03928316921682116140d1575050600f0b6140ba81614748565b6001600160801b03928316921682116140d1575050565b6140da90614748565b630940b79160e11b5f9081526004929092526001600160801b0316602452604490fd5b5f81815260076020526040902080546001600160a01b03169561417695610cd9959394919390929091906141309061285e565b60405163b1a9116f60e01b602082015260248101959095526001600160a01b031660448501526064840152608483015260a4808301919091528152610cd360c4826105cd565b61417d5750565b612b4f565b919061418f602091613c3a565b604051631e2eaeaf60e01b8152600481019190915292839060249082906001600160a01b03165afa918215610ff0575f926141ed575b506001600160a01b0382169160a081901c60020b9162ffffff60b883901c81169260d01c1690565b61420791925060203d6020116127165761270881836105cd565b905f6141c5565b60020b908160ff1d82810118620d89e881116145285763ffffffff9192600182167001fffcb933bd6fad37aa2d162d1a59400102600160801b18916002811661450c575b600481166144f0575b600881166144d4575b601081166144b8575b6020811661449c575b60408116614480575b60808116614464575b6101008116614448575b610200811661442c575b6104008116614410575b61080081166143f4575b61100081166143d8575b61200081166143bc575b61400081166143a0575b6180008116614384575b620100008116614368575b62020000811661434d575b620400008116614332575b6208000016614319575b5f12614311575b0160201c90565b5f190461430a565b6b048a170391f7dc42444e8fa290910260801c90614303565b6d2216e584f5fa1ea926041bedfe9890920260801c916142f9565b916e5d6af8dedb81196699c329225ee6040260801c916142ee565b916f09aa508b5b7a84e1c677de54f3e99bc90260801c916142e3565b916f31be135f97d08fd981231505542fcfa60260801c916142d8565b916f70d869a156d2a1b890bb3df62baf32f70260801c916142ce565b916fa9f746462d870fdf8a65dc1f90e061e50260801c916142c4565b916fd097f3bdfd2022b8845ad8f792aa58250260801c916142ba565b916fe7159475a2c29b7443b29c7fa6e889d90260801c916142b0565b916ff3392b0822b70005940c7a398e4b70f30260801c916142a6565b916ff987a7253ac413176f2b074cf7815e540260801c9161429c565b916ffcbe86c7900a88aedcffc83b479aa3a40260801c91614292565b916ffe5dee046a99a2a811c461f1969c30530260801c91614288565b916fff2ea16466c96a3843ec78b326b528610260801c9161427f565b916fff973b41fa98c081472e6896dfb254c00260801c91614276565b916fffcb9843d60f6159c9db58835c9266440260801c9161426d565b916fffe5caca7e10e4e61c3624eaa0941cd00260801c91614264565b916ffff2e50f5f656932ef12357cf3c7fdcc0260801c9161425b565b916ffff97272373d413259a46990580e213a0260801c91614252565b8261475e565b936001600160a01b03838116908316116145b5575b6001600160a01b0385811695908316861161456457505061032593506147ad565b919490939192906001600160a01b03821611156145a957829161458b9161459195946147ad565b93614773565b6001600160801b038181169083161015612f99575090565b91505061032592614773565b909190614543565b95939460409161460a6145ce611e00565b60088a901c60020b81529260208a811c60020b90850152858585015286606085015284519889948594632d35e7ed60e11b865260048601613694565b03815f7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165af1908115610ff0575f945f92614662575b5081949560ff1661465957505050565b6102c1926147fa565b90945061467e915060403d6040116136575761364381836105cd565b90935f614649565b908160801d600f0b91600f0b915f811280614717575b6146f15750505f8112806146d3575b6146b3575050565b906146c36134fc610d2d936131c3565b63031e30ad60e41b5f5290614074565b506146dd816131c3565b6001600160801b03908116908316106146ab565b906146fe610d2d926131c3565b63031e30ad60e41b5f526001600160801b031690614074565b506001600160801b03614729826131c3565b166001600160801b0383161061469c565b9081600f0b91820361403257565b5f81600f0b12614032576001600160801b031690565b6345c3193d60e11b5f5260020b60045260245ffd5b610325926147a29290916001600160a01b03808316908216116147a7575b90036001600160a01b0316906148bd565b614a16565b90614791565b610325926147a2929091906001600160a01b03808216908316116147f4575b6147e26001600160a01b0382811690841661494a565b9190036001600160a01b031691614993565b906147cc565b61484a9192815f52600760205260018060a01b0360405f205416936040519263d8865c2760e01b6020850152602484015260448301526064820152606481526148446084826105cd565b826129e4565b156148525750565b6040516390bfb86560e01b8152600481019190915263d8865c2760e01b602482015260806044820152601f3d01601f191660a0810160648301523d60848301523d5f60a484013e808201600460a482015260c46374a7887160e11b91015260e40190fd5b156102b257565b90606082901b905f19600160601b84099282808510940393808503946148e48685116148b6565b14614943578190600160601b900981805f03168092046002816003021880820260020302808202600203028082026002030280820260020302808202600203028091026002030293600183805f03040190848311900302920304170290565b5091500490565b81810291905f1982820991838084109303928084039384600160601b11156102b2571461498a57600160601b910990828211900360a01b910360601c1790565b50505060601c90565b91818302915f198185099383808610950394808603956149b48786116148b6565b14614a0e579082910981805f03168092046002816003021880820260020302808202600203028082026002030280820260020302808202600203028091026002030293600183805f03040190848311900302920304170290565b505091500490565b6001600160801b03811691908290036140325756fe0aedd6bde10e3aa2adec092b02a3e3e805795516cda41f27aa145b8f300af87addf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa2646970667358221220596c32c74b193093a6ed8e3db3acfc234a58a08e8c47bb9f3f38f727d94c7a1d64736f6c634300081a0033";
}

//contract PositionManager is PositionManagerCore {
//
//    constructor(PoolManager _manager, PositionDescriptor _positionsDescriptor)
//        PositionManagerCore(_manager, IAllowanceTransfer(Preinstalls.Permit2), 300_000, _positionsDescriptor, IWETH9(Predeploys.WETH))
//    {}
//
//    function _pay(Currency token, address payer, uint256 amount) internal override {
//        if (payer == address(this)) {
//            token.transfer(address(poolManager), amount);
//        } else {
//            // @dev supersim version swaps the permit2 with a direct transferFrom call
//            ERC20(Currency.unwrap(token)).transferFrom(payer, address(poolManager), amount);
//        }
//    }
//}